"""Vulnerability entity representing security vulnerabilities."""

from __future__ import annotations

from typing import ClassVar, Literal

from pydantic import Field

from hc_enterprise_kg.domain.base import BaseEntity, EntityType


class Vulnerability(BaseEntity):
    """Represents a security vulnerability."""

    ENTITY_TYPE: ClassVar[EntityType] = EntityType.VULNERABILITY
    entity_type: Literal[EntityType.VULNERABILITY] = EntityType.VULNERABILITY

    cve_id: str = ""
    cvss_score: float | None = None
    cvss_vector: str = ""
    severity: str = "medium"  # low, medium, high, critical
    status: str = "open"  # open, mitigated, accepted, resolved
    exploit_available: bool = False
    patch_available: bool = False
    affected_component: str = ""
    discovery_date: str | None = None
    remediation_deadline: str | None = None
    affected_system_ids: list[str] = Field(default_factory=list)
